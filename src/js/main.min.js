var domCache={$window:$(window),$body:$("body"),$videoPopup:null,$wallpaperPopup:null,$termsPopup:null,$imagePopup:null,$mobileMenu:null,$mobileMenuOverlay:null,$menuBtn:null,$closeBtn:null,init:function(){this.$videoPopup=$(".video-popup"),this.$wallpaperPopup=$(".wallpaper-popup"),this.$termsPopup=$(".terms-popup"),this.$imagePopup=$(".image-popup"),this.$mobileMenu=$(".mobile-menu"),this.$mobileMenuOverlay=$(".mobile-menu-overlay"),this.$menuBtn=$(".menu_btn"),this.$closeBtn=$(".mobile-menu .close-btn")}},scrollConfig={downloadOffset:100,themeOffset:{desktop:250,tablet:200,mobile:150},animationDuration:600,easing:"swing",breakpoints:{tablet:768,mobile:576},getThemeOffset:function(){var e=$(window).width();return e<=this.breakpoints.mobile?this.themeOffset.mobile:e<=this.breakpoints.tablet?this.themeOffset.tablet:this.themeOffset.desktop}};function debounce(e,t){var o;return function(){var n=this,i=arguments;clearTimeout(o),o=setTimeout(function(){o=null,e.apply(n,i)},t)}}var MarqueeController={tracks:null,originalContent:{},resetInterval:null,isInitialized:!1,init:function(){this.isInitialized||(this.tracks=document.querySelectorAll(".marquee .track"),0!==this.tracks.length&&(this.tracks.forEach(function(e,t){MarqueeController.originalContent[t]=e.innerHTML}),this.isInitialized=!0))},start:function(){this.isInitialized||this.init(),0!==this.tracks.length&&(this.resetInterval&&clearInterval(this.resetInterval),this.resetAnimation(),this.resetInterval=setInterval(function(){MarqueeController.resetAnimation()},3e4))},resetAnimation:function(){var e=this;this.tracks.forEach(function(t,o){t.style.animation="none",t.innerHTML=e.originalContent[o],t.innerHTML+=e.originalContent[o],t.offsetHeight,t.style.animation=null})},stop:function(){this.resetInterval&&(clearInterval(this.resetInterval),this.resetInterval=null)}};function openModal(e){domCache.$videoPopup.filter(":visible").hide().attr("aria-hidden","true"),domCache.$wallpaperPopup.filter(":visible").hide().attr("aria-hidden","true"),domCache.$termsPopup.filter(":visible").hide().attr("aria-hidden","true"),domCache.$imagePopup.filter(":visible").hide().attr("aria-hidden","true");var t=domCache.$window.scrollTop();domCache.$body.data("scroll-position",t),domCache.$body.addClass("modal-open").css("top",-t+"px"),domCache.$window.off("scroll.menuFix"),e.css("display","flex").attr("aria-hidden","false");var o=e.find(".close-btn").first();o.length&&o.trigger("focus")}function closeModal(e){e.css("display","none").attr("aria-hidden","true");var t=domCache.$body.data("scroll-position")||0;domCache.$body.removeClass("modal-open").css("top",""),domCache.$window.scrollTop(t),setTimeout(function(){initMenuFixScroll()},50)}function getMarqueeHeight(){var e=$(".marquee");return e.length?e.outerHeight():window.innerWidth<=576?40:window.innerWidth<=1024?50:60}function getMenuFixPosition(){return getMarqueeHeight()}function getHideTransform(){return"translateY(-"+($(".menu_fix").outerHeight()||70)+"px)"}function initMenuFixScroll(){domCache.$window.on("scroll.menuFix",debounce(function(){var e=$(".menu"),t=$(".menu_fix");if(e.length&&t.length){var o=e.offset().top+e.outerHeight(),n=domCache.$window.scrollTop(),i=getMarqueeHeight();n>o?t.css({top:i+"px",transform:"translateY(0)","box-shadow":"0 7px 0px rgba(0, 0, 0, 0.1)"}):t.css({top:"0px",transform:getHideTransform(),"box-shadow":"none"})}},16))}document.addEventListener("DOMContentLoaded",function(){MarqueeController.init()}),document.addEventListener("visibilitychange",function(){!document.hidden&&MarqueeController.isInitialized&&MarqueeController.start()}),$(function(){domCache.init();var e=domCache.$videoPopup;$("#playbtn").on("click",function(t){t.preventDefault(),openModal(e)}),$(".video-popup .close-btn").on("click",function(){var t=e.find("iframe");t.attr("src",t.attr("src")),closeModal(e)}),e.on("click",function(t){if(t.target===this){var o=e.find("iframe");o.attr("src",o.attr("src")),closeModal(e)}})}),$(function(){var e=$(".theme .wallpaper-popup");$(".theme .download .btn").on("click keydown",function(t){"click"!==t.type&&("keydown"!==t.type||"Enter"!==t.key&&" "!==t.key)||(t.preventDefault(),$(document).data("lastTrigger",this),e.parent().hasClass("theme")&&(e.data("original-parent",e.parent()),e.appendTo("body")),openModal(e))}),$(".theme .wallpaper-popup .close-btn").on("click",function(){closeModal(e);var t=e.data("original-parent");t&&t.length&&e.appendTo(t);var o=$(document).data("lastTrigger");o&&$(o).focus()}),e.on("click",function(t){if(t.target===this){closeModal(e);var o=e.data("original-parent");o&&o.length&&e.appendTo(o);var n=$(document).data("lastTrigger");n&&$(n).focus()}}),$(document).on("keydown",function(t){if("Escape"===t.key){var o=$(".video-popup");if(o.is(":visible")){var n=o.find("iframe");return n.attr("src",n.attr("src")),void closeModal(o)}if(e.is(":visible")){closeModal(e);var i=e.data("original-parent");i&&i.length&&e.appendTo(i);var a=$(document).data("lastTrigger");a&&$(a).focus()}}})}),$(function(){var e=$(".terms-popup");$(document).on("click keydown",'a[data-popup="terms"], .open-terms, .terms-btn',function(t){"click"!==t.type&&("keydown"!==t.type||"Enter"!==t.key&&" "!==t.key)||(t.preventDefault(),$(document).data("lastTrigger",this),openModal(e))}),$(document).on("click",".terms-popup .close-btn",function(){closeModal(e);var t=$(document).data("lastTrigger");t&&$(t).focus()}),e.on("click",function(t){if(t.target===this){closeModal(e);var o=$(document).data("lastTrigger");o&&$(o).focus()}}),$(document).on("keydown",function(t){if("Escape"===t.key&&e.is(":visible")){closeModal(e);var o=$(document).data("lastTrigger");o&&$(o).focus()}})}),$(function(){var e=$(".image-popup");$(document).on("click",".weartocare .card img[data-large], .carousel-slide img[data-large]",function(t){t.preventDefault(),t.stopPropagation();var o=$(this),n=o.attr("data-large")||o.attr("src"),i=o.attr("alt")||"圖片預覽";e.find(".preview img").attr("src",n).attr("alt",i),$(document).data("lastTrigger",this),openModal(e)}),$(".image-popup .close-btn").on("click",function(){closeModal(e);var t=$(document).data("lastTrigger");t&&$(t).focus()}),e.on("click",function(t){if(t.target===this){closeModal(e);var o=$(document).data("lastTrigger");o&&$(o).focus()}}),$(document).on("keydown",function(t){if("Escape"===t.key&&e.is(":visible")){closeModal(e);var o=$(document).data("lastTrigger");o&&$(o).focus()}})}),$(function(){var e=$(".menu"),t=$(".menu_fix");$(".marquee");e.length&&t.length&&(t.css({top:"0px",transform:getHideTransform(),transition:"transform 0.3s ease-in-out, top 0.3s ease-in-out","box-shadow":"none"}),initMenuFixScroll(),domCache.$window.on("resize",debounce(function(){if(domCache.$window.scrollTop()>e.offset().top+e.outerHeight()){var o=getMarqueeHeight();t.css({top:o+"px",transform:"translateY(0)"})}else t.css({top:"0px",transform:getHideTransform()})},250)))}),$(function(){var e=domCache.$menuBtn,t=domCache.$mobileMenu,o=domCache.$mobileMenuOverlay,n=domCache.$closeBtn;function i(){t.removeClass("active"),o.removeClass("active")}e.on("click",function(e){e.preventDefault(),t.addClass("active"),o.addClass("active")}),n.on("click",function(e){e.preventDefault(),i()}),o.on("click",function(e){e.target===this&&i()}),$(".mobile-menu-item").on("click",function(){i()}),$(document).on("keydown",function(e){"Escape"===e.key&&t.hasClass("active")&&i()}),domCache.$window.on("resize",debounce(function(){window.innerWidth>1024&&t.hasClass("active")&&i()},250))}),$(document).ready(function(){$("body").addClass("loading-lock"),window.scrollTo(0,0),$(".theme").css({display:"flex",visibility:"visible"}),$(".theme .wallpaper-popup, .theme .popup").hide(),console.log("Theme section preloaded and made visible during page load")}),domCache.$window.on("load",function(){setTimeout(function(){$(".loading-screen").addClass("slide-up"),setTimeout(function(){$(".loading-screen").remove(),$("body").removeClass("loading-lock"),void 0!==MarqueeController&&MarqueeController.start(),setTimeout(function(){$(".fade_fv").addClass("fade-in")},300),setTimeout(function(){$(".fade_sticker").addClass("fade-in")},500)},400)},1e3)}),$(function(){$('a[href="#download"], a.download').on("click",function(e){e.preventDefault(),$("html, body").stop(!0,!0),setTimeout(function(){var e=$("#download");e.length?(document.body.offsetHeight,e[0].offsetHeight,$(window).trigger("resize"),setTimeout(function(){var t=e.offset().top-100;console.log("Using offset:",100),console.log("Target position calculated:",t),console.log("Current scroll position:",$(window).scrollTop()),$("html, body").animate({scrollTop:t},{duration:600,easing:"swing",complete:function(){console.log("Scroll completed at position:",$(window).scrollTop()),setTimeout(function(){var t=e.offset().top-100,o=$(window).scrollTop();Math.abs(o-t)>10&&(console.log("Position correction needed, adjusting..."),window.scrollTo(0,t))},100)}})},50)):console.log("Target element not found!")},100)})}),$(function(){$('a[href="#theme"]').on("click",function(e){e.preventDefault(),$("html, body").stop(!0,!0),setTimeout(function(){var e=$(".theme");e.length?(document.body.offsetHeight,e[0].offsetHeight,$(window).trigger("resize"),setTimeout(function(){var t=scrollConfig.getThemeOffset(),o=e.offset().top-t;console.log("Theme button clicked"),console.log("Using responsive offset:",t),console.log("Target position calculated:",o),console.log("Current scroll position:",$(window).scrollTop()),$("html, body").animate({scrollTop:o},{duration:scrollConfig.animationDuration,easing:scrollConfig.easing,complete:function(){console.log("Theme scroll completed at position:",$(window).scrollTop()),setTimeout(function(){var o=e.offset().top-t,n=$(window).scrollTop();Math.abs(n-o)>10&&(console.log("Theme position correction needed, adjusting..."),window.scrollTo(0,o))},100)}})},50)):console.log("Theme target element not found!")},100)})}),$(function(){$(".menu .logo, .menu_fix .logo").on("click",function(e){e.preventDefault(),$("html, body").stop(!0,!0),console.log("Logo clicked, scrolling to top"),console.log("Current scroll position:",$(window).scrollTop()),$("html, body").animate({scrollTop:0},{duration:scrollConfig.animationDuration,easing:scrollConfig.easing,complete:function(){console.log("Scroll to top completed")}})})}),$(function(){$(".carousel-container").each(function(){var e,t=$(this),o=t.find(".carousel-track"),n=t.find(".carousel-slide"),i=t.find(".dot"),a=n.length,r=1,l=!1,s={startX:0,startY:0,currentX:0,currentY:0,isDragging:!1,isVerticalScroll:!1,startTime:0,moved:!1};if(!(a<=1)){var c=o[0];c.addEventListener("touchstart",m,{passive:!1}),c.addEventListener("touchmove",g,{passive:!1}),c.addEventListener("touchend",h,{passive:!1}),c.addEventListener("touchcancel",h,{passive:!1}),"ontouchstart"in window||(o.on("mousedown",function(e){m(e)}),$(document).on("mousemove",function(e){s.isDragging&&g(e)}),$(document).on("mouseup",function(e){s.isDragging&&h()})),o.on("click",function(e){s.moved&&(e.preventDefault(),e.stopPropagation())}),i.on("click",function(){!function(e){l||(r=e+1,u())}($(this).data("slide")),clearInterval(e),v()}),t.find(".carousel-prev").on("click",function(t){t.preventDefault(),t.stopPropagation(),p(),clearInterval(e),v()}),t.find(".carousel-next").on("click",function(t){t.preventDefault(),t.stopPropagation(),f(),clearInterval(e),v()}),t.on("mouseenter",function(){clearInterval(e)}),t.on("mouseleave",function(){s.isDragging||v()}),function(){var e=n.last().clone();o.prepend(e);var t=n.first().clone();o.append(t),o.css({transform:"translateX(-100%)",transition:"none"})}(),u(),v()}function u(e){var t=100*-r;e?o.css({transform:"translateX("+t+"%)",transition:"none"}):o.css({transform:"translateX("+t+"%)",transition:"transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)"});var n=((r-1)%a+a)%a;i.removeClass("active"),i.eq(n).addClass("active")}function d(){l||(r>=a+1?(l=!0,setTimeout(function(){r=1,u(!0),l=!1},300)):r<=0&&(l=!0,setTimeout(function(){r=a,u(!0),l=!1},300)))}function f(){l||(r++,u(),d())}function p(){l||(r--,u(),d())}function m(t){if(!l){var n=t.touches?t.touches[0]:t;s.startX=n.clientX,s.startY=n.clientY,s.currentX=n.clientX,s.currentY=n.clientY,s.isDragging=!0,s.isVerticalScroll=!1,s.startTime=Date.now(),s.moved=!1,clearInterval(e),o.css("transition","none")}}function g(e){if(s.isDragging&&!l){var n=e.touches?e.touches[0]:e;s.currentX=n.clientX,s.currentY=n.clientY;var i=s.currentX-s.startX,a=s.currentY-s.startY,c=Math.abs(i),u=Math.abs(a);if(!s.moved&&(c>5||u>5)&&(s.moved=!0,u>1.5*c&&(s.isVerticalScroll=!0)),!s.isVerticalScroll&&s.moved){e.preventDefault();var d=i/t.width()*100,f=100*-r+d;o.css("transform","translateX("+f+"%)")}}}function h(e){if(s.isDragging){if(s.isDragging=!1,s.isVerticalScroll)return u(),void v();var o=s.currentX-s.startX,n=Date.now()-s.startTime,i=Math.abs(o)/n,a=.15*t.width();(Math.abs(o)>a||i>.3)&&s.moved?o>0?p():f():u(),v()}}function v(){clearInterval(e),e=setInterval(f,4e3)}})}),document.addEventListener("DOMContentLoaded",function(){const e=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&e.target.classList.add("fade-in")})},{threshold:.2,rootMargin:"0px 0px -50px 0px"});function t(){document.querySelectorAll(".fade, .fade-fast, .fade-slow, .fade_text, .fade_text-fast, .fade_text-slow").forEach(function(t){t.classList.contains("fade-in")||e.observe(t)})}t(),window.refreshFadeAnimation=function(){t()}}),setTimeout(function(){void 0!==MarqueeController&&(document.querySelector(".loading-screen")?setTimeout(function(){MarqueeController.start()},2e3):MarqueeController.start())},3e3),/Mobi|Android/i.test(navigator.userAgent)&&(window.addEventListener("focus",function(){setTimeout(function(){void 0!==MarqueeController&&MarqueeController.isInitialized&&MarqueeController.start()},500)}),document.addEventListener("touchstart",function(){setTimeout(function(){if(void 0!==MarqueeController&&MarqueeController.isInitialized){var e=document.querySelectorAll(".marquee .track"),t=!1;e.forEach(function(e){e.style.animation&&"none"!==e.style.animation&&(t=!0)}),t||MarqueeController.start()}},1e3)},{once:!0}));
//# sourceMappingURL=main.min.js.map